<div class="flex flex-col gap-2 divide-y divide-gray-300 dark:divide-gray-700">
  <div class="flex justify-between pb-2">
    @if (resourceRef().status() !== 'loading') {
      <div class="flex">
        <button
          uiButton
          [ngpTooltipTrigger]="RefreshTooltip"
          [ngpTooltipTriggerContainer]="tooltipContainer"
          (click)="resourceRef().reload()">
          <span class="sr-only">Reload data</span>
          <ng-icon
            name="heroArrowPath" />
        </button>
        <ng-template #RefreshTooltip>
          <ui-tooltip>{{ 'misc.refresh' | translate }}</ui-tooltip>
        </ng-template>

        <div #tooltipContainer></div>
      </div>

      <button
        uiButton
        [ngpMenuTrigger]="pageSizeDropdown"
        class="data-open:*:[ng-icon]:rotate-180">
        {{ pageSize() }}
        <ng-icon
          name="heroChevronDown"
          class="ml-2 transition-transform duration-150 ease-in-out" />
      </button>
      <ng-template #pageSizeDropdown>
        <ui-menu>
          @for (size of pageSizes; track $index) {
            <button
              uiMenuItem
              (click)="pageSize.set(size)">
              {{ size }}
            </button>
          }
        </ui-menu>
      </ng-template>
    }
  </div>
  <div class="flex flex-col gap-2">
    @if (resourceRef().isLoading()) {
      <ui-loader />
    } @else if (resourceRef().error()) {
      <div class="flex flex-col gap-2">
        <div class="flex flex-col gap-2">
          <div>
            <span class="font-semibold">{{ 'misc.error.name' | translate }}</span>
          </div>
          <span>{{ resourceRef().error()?.name ?? '' }}</span>
        </div>
        <div class="flex flex-col gap-2">
          <div>
            <span class="font-semibold">{{ 'misc.error.message' | translate }}</span>
          </div>
          <span>{{ resourceRef().error()?.message ?? '' }}</span>
        </div>
      </div>
    } @else if (resourceRef().hasValue()) {
      @let value = resourceRef().value();

      @if (value !== undefined && value.data.length > 0) {
        <table
          uiTable
          [tableHeader]="header()"
          [tableBody]="body()"
          [tableFooter]="footer()"
          [data]="value.data"></table>

        <ui-pagination
          class="self-end"
          [pageCount]="value.totalPages"
          [(page)]="pageNumber" />
      } @else {
        <p class="font-medium">{{ 'misc:noData' | translate }}</p>
      }
    }
  </div>
</div>
